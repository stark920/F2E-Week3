import{d as A,j as L,u as R,s as N,k as S,z as U,b as s,c as n,f as a,t as u,h as l,e as g,K as w,F as y,m,y as c,p as f}from"./index.e97ecd69.js";import{a as B,_ as F}from"./RouteDetail.aa8c9ed4.js";import{a as T,_ as E}from"./NearbyStationsDetail.cc19c9eb.js";import{u as I,b as P}from"./IconRefresh.44757ed6.js";import{u as Z}from"./map.834fb6e3.js";const j={key:0,class:"flex h-full w-full flex-col"},M={class:"flex h-[4rem] items-end justify-center"},z={class:"text-xl font-bold"},K={class:"flex-c h-[4rem]"},W={value:"All"},q=["value"],G={value:"All"},H=["value"],J={class:"flex h-[3rem]"},O=a("input",{type:"radio",name:"direction",class:"peer hidden",checked:""},null,-1),Q={class:"flex-c h-full cursor-pointer gap-2 rounded-t-md bg-gray-300 px-2 peer-checked:bg-primary peer-checked:text-white"},X=a("input",{type:"radio",name:"direction",class:"peer hidden"},null,-1),Y={class:"flex-c h-full cursor-pointer gap-2 rounded-t-md bg-gray-300 px-2 peer-checked:bg-primary peer-checked:text-white"},ee={class:"h-[calc(100%-9rem)] overflow-y-scroll px-2"},te={key:1,class:"flex h-full w-full flex-col"},re=A({__name:"CollectBoard",setup(oe){const{t:r}=L(),v=R(),h=I(),_=Z(),{likeRoutes:p,likeStations:d}=N(h),D=(()=>{if(p.value.length===0)return[];const i=[];return p.value.forEach(o=>{i.includes(o.City)||i.push(o.City)}),i})(),x=(()=>{if(d.value.length===0)return[];const i=[];return d.value.forEach(o=>{i.includes(o.City)||i.push(o.City)}),i})(),V=S(()=>t.routeSelectedCity==="All"?p.value:p.value.filter(i=>i.City===t.routeSelectedCity)),b=S(()=>t.stationSelectedCity==="All"?d.value:d.value.filter(i=>i.City===t.stationSelectedCity)),t=U({displayView:"route",routeSelectedCity:"All",stationSelectedCity:"All",routeData:{},routeDetailData:{go:[],back:[],circle:[]},stationDetailData:[],showLikeStations(){_.nearbyStationsData=d.value,this.displayView="station"},async showRouteDetail(i){const o=await P.getRouteWithArrivalTime(i.City,i.RouteName.Zh_tw);o?(this.routeDetailData=o,this.routeData=i,this.displayView="route-detail"):v.error("\u53D6\u5F97\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66")},showStopDetail(i){_.selectedStationData=i,this.displayView="station-detail"}});return(i,o)=>["route","station"].includes(t.displayView)?(s(),n("div",j,[a("section",M,[a("h3",z,u(l(r)("page.collect")),1)]),a("section",K,[t.displayView==="route"?g((s(),n("select",{key:0,"onUpdate:modelValue":o[0]||(o[0]=e=>t.routeSelectedCity=e),class:"rounded-md border-none bg-gray-300 py-1 text-gray-700 focus:ring-0"},[a("option",W,u(l(r)("allCity")),1),(s(!0),n(y,null,m(l(D),e=>(s(),n("option",{key:e,value:e},u(l(r)(`city.${e}`)),9,q))),128))],512)),[[w,t.routeSelectedCity]]):c("",!0),t.displayView==="station"?g((s(),n("select",{key:1,"onUpdate:modelValue":o[1]||(o[1]=e=>t.stationSelectedCity=e),class:"rounded-md border-none bg-gray-300 py-1 text-gray-700 focus:ring-0"},[a("option",G,u(l(r)("allCity")),1),(s(!0),n(y,null,m(l(x),e=>(s(),n("option",{key:e,value:e},u(l(r)(`city.${e}`)),9,H))),128))],512)),[[w,t.stationSelectedCity]]):c("",!0)]),a("section",J,[a("label",{class:"flex-grow",onChange:o[2]||(o[2]=e=>t.displayView="route")},[O,a("div",Q,u(l(r)("collect.route")),1)],32),a("label",{class:"flex-grow",onChange:o[3]||(o[3]=(...e)=>t.showLikeStations&&t.showLikeStations(...e))},[X,a("div",Y,u(l(r)("collect.station")),1)],32)]),a("div",ee,[t.displayView==="route"?(s(!0),n(y,{key:0},m(l(V),e=>(s(),f(F,{key:e.RouteUID,data:e,onClick:k=>t.showRouteDetail(e)},null,8,["data","onClick"]))),128)):t.displayView==="station"?(s(!0),n(y,{key:1},m(l(b),(e,k)=>{var C;return s(),f(E,{key:e.StationUID,index:k,uid:e.StationUID,name:e.StationName.Zh_tw,"name-en":(C=e.StationName.En)!=null?C:e.StationName.Zh_tw,lat:e.StationPosition.PositionLat,lng:e.StationPosition.PositionLon,"stops-num":e.StopsNum,onClick:$=>t.showStopDetail(e),onToggleLike:$=>l(h).toggleLikeStations(e)},null,8,["index","uid","name","name-en","lat","lng","stops-num","onClick","onToggleLike"])}),128)):c("",!0)])])):(s(),n("div",te,[t.displayView==="route-detail"?(s(),f(B,{key:0,route:t.routeData,data:t.routeDetailData,onUpdateDetail:t.showRouteDetail,onCloseDetail:o[4]||(o[4]=e=>t.displayView="route")},null,8,["route","data","onUpdateDetail"])):c("",!0),t.displayView==="station-detail"?(s(),f(T,{key:1,onCloseDetail:o[5]||(o[5]=e=>t.displayView="station")})):c("",!0)]))}});export{re as default};
