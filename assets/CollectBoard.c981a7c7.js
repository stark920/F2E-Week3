import{d as S,j as b,u as V,s as A,l as R,k as m,b as a,c as r,f as l,t as u,h as i,e as _,J as C,F as c,p as d,D as f,x as h}from"./index.1fde3d96.js";import{a as $,_ as B}from"./RouteDetail.c44eb48e.js";import{_ as F}from"./NearbyDetail.efbfd86b.js";import{u as U,b as E}from"./api.89715e17.js";import"./map.cb522d94.js";const I={class:"flex h-full flex-col"},N={class:"flex h-[4rem] items-end justify-center"},T={class:"text-xl font-bold"},j={class:"flex-c h-[4rem]"},L={value:"All"},J=["value"],M={value:"All"},W=["value"],Z={class:"flex h-[3rem]"},q=l("input",{type:"radio",name:"direction",class:"peer hidden",checked:""},null,-1),z={class:"flex-c h-full cursor-pointer gap-2 rounded-t-md bg-gray-300 px-2 peer-checked:bg-primary peer-checked:text-white"},G=l("input",{type:"radio",name:"direction",class:"peer hidden"},null,-1),H={class:"flex-c h-full cursor-pointer gap-2 rounded-t-md bg-gray-300 px-2 peer-checked:bg-primary peer-checked:text-white"},K={class:"h-[calc(100%-9rem)] overflow-y-scroll px-2"},oe=S({__name:"CollectBoard",setup(O){const{t:n}=b(),v=V(),g=U(),{likeRoutes:p,likeStops:y}=A(g),k=(()=>{const s=[];return p.value.forEach(o=>{s.includes(o.City)||s.push(o.City)}),s})(),D=(()=>{const s=[];return y.value.forEach(o=>{s.includes(o.City)||s.push(o.City)}),s})(),t=R({displayView:"route",routeSelectedCity:"All",stopSelectedCity:"All",routeData:{},routeDetailData:{go:[],back:[],circle:[]},async showRouteDetail(s){const o=await E.getRouteWithArrivalTime(s.City,s.RouteName.Zh_tw);o?(this.routeDetailData=o,this.routeData=s,this.displayView="route-detail"):v.error("\u53D6\u5F97\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66")}}),w=m(()=>t.routeSelectedCity==="All"?p.value:p.value.filter(s=>s.City===t.routeSelectedCity)),x=m(()=>t.stopSelectedCity==="All"?y.value:y.value.filter(s=>s.City===t.stopSelectedCity));return(s,o)=>(a(),r("div",I,[l("section",N,[l("h3",T,u(i(n)("page.collect")),1)]),l("section",j,[t.displayView==="route"?_((a(),r("select",{key:0,"onUpdate:modelValue":o[0]||(o[0]=e=>t.routeSelectedCity=e),class:"rounded-md border-none bg-gray-300 py-1 text-gray-700 focus:ring-0"},[l("option",L,u(i(n)("allCity")),1),(a(!0),r(c,null,d(i(k),e=>(a(),r("option",{key:e,value:e},u(i(n)(`city.${e}`)),9,J))),128))],512)),[[C,t.routeSelectedCity]]):f("",!0),t.displayView==="stop"?_((a(),r("select",{key:1,"onUpdate:modelValue":o[1]||(o[1]=e=>t.stopSelectedCity=e),class:"rounded-md border-none bg-gray-300 py-1 text-gray-700 focus:ring-0"},[l("option",M,u(i(n)("allCity")),1),(a(!0),r(c,null,d(i(D),e=>(a(),r("option",{key:e,value:e},u(i(n)(`city.${e}`)),9,W))),128))],512)),[[C,t.stopSelectedCity]]):f("",!0)]),l("section",Z,[l("label",{class:"flex-grow",onChange:o[2]||(o[2]=e=>t.displayView="route")},[q,l("div",z,u(i(n)("collect.route")),1)],32),l("label",{class:"flex-grow",onChange:o[3]||(o[3]=e=>t.displayView="stop")},[G,l("div",H,u(i(n)("collect.stop")),1)],32)]),l("div",K,[t.displayView==="route"?(a(!0),r(c,{key:0},d(i(w),e=>(a(),h(B,{key:e.RouteUID,data:e,onClick:P=>t.showRouteDetail(e)},null,8,["data","onClick"]))),128)):t.displayView==="stop"?(a(!0),r(c,{key:1},d(i(x),e=>(a(),h(F,{key:e.RouteUID,data:e},null,8,["data"]))),128)):t.displayView==="route-detail"?(a(),h($,{key:2,route:t.routeData,data:t.routeDetailData,onUpdateDetail:t.showRouteDetail,onCloseDetail:o[4]||(o[4]=e=>t.displayView="route")},null,8,["route","data","onUpdateDetail"])):f("",!0)])]))}});export{oe as default};
